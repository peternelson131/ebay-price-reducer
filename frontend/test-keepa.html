<!DOCTYPE html>
<html>
<head>
    <title>Test Keepa API</title>
</head>
<body>
    <h1>Test Keepa API Key Validation</h1>
    <input type="text" id="apiKey" placeholder="Enter Keepa API Key" style="width: 300px;">
    <button onclick="testKeepa()">Test Direct Keepa API</button>
    <button onclick="testNetlifyFunction()">Test via Netlify Function</button>
    <div id="result"></div>

    <script>
        async function testKeepa() {
            const apiKey = document.getElementById('apiKey').value;
            const resultDiv = document.getElementById('result');

            try {
                const response = await fetch(`https://api.keepa.com/token?key=${apiKey}`);
                const data = await response.json();
                resultDiv.innerHTML = `<pre>Direct Keepa API Result:\n${JSON.stringify(data, null, 2)}</pre>`;
            } catch (error) {
                resultDiv.innerHTML = `<pre>Error: ${error.message}</pre>`;
            }
        }

        async function testNetlifyFunction() {
            const apiKey = document.getElementById('apiKey').value;
            const resultDiv = document.getElementById('result');

            // Get a real auth token first (you'd need to be logged in)
            const token = prompt('Enter your Supabase auth token (from browser dev tools)');

            try {
                const response = await fetch('https://dainty-horse-49c336.netlify.app/.netlify/functions/keepa-api/api-key', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({ apiKey })
                });
                const data = await response.json();
                resultDiv.innerHTML = `<pre>Netlify Function Result:\n${JSON.stringify(data, null, 2)}</pre>`;
            } catch (error) {
                resultDiv.innerHTML = `<pre>Error: ${error.message}</pre>`;
            }
        }
    </script>
</body>
</html>