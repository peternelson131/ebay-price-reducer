import{u as w,j as e,S as N,X as C}from"./index-0231291c.js";import{r}from"./vendor-react-4c62d1cf.js";import{R as _}from"./refresh-cw-6c475bbf.js";import{L as k,C as A}from"./loader-43bf0082.js";import{E as S}from"./external-link-a2bb9e65.js";import"./vendor-supabase-5edd3635.js";import"./vendor-query-4b12add6.js";const h={US:{name:"United States",flag:"ðŸ‡ºðŸ‡¸",domain:"amazon.com"},CA:{name:"Canada",flag:"ðŸ‡¨ðŸ‡¦",domain:"amazon.ca"},UK:{name:"United Kingdom",flag:"ðŸ‡¬ðŸ‡§",domain:"amazon.co.uk"},DE:{name:"Germany",flag:"ðŸ‡©ðŸ‡ª",domain:"amazon.de"}};function R(){const[l,y]=r.useState([]),[i,x]=r.useState(!0),[c,p]=r.useState(""),[n,u]=r.useState("all");r.useEffect(()=>{f()},[]);const f=async()=>{x(!0);try{const s=await w.getAuthToken(),t=await(await fetch("/.netlify/functions/influencer-tasks?status=completed",{headers:{Authorization:`Bearer ${s}`}})).json();t.success&&y(t.tasks||[])}catch(s){console.error("Failed to load completed tasks:",s)}finally{x(!1)}},g=r.useMemo(()=>l.filter(s=>{var a,t,o;if(n!=="all"&&s.marketplace!==n)return!1;if(c){const d=c.toLowerCase(),b=((a=s.asin)==null?void 0:a.toLowerCase().includes(d))||((t=s.search_asin)==null?void 0:t.toLowerCase().includes(d)),v=(o=s.product_title)==null?void 0:o.toLowerCase().includes(d);if(!b&&!v)return!1}return!0}),[l,n,c]),m=r.useMemo(()=>{const s={};return g.forEach(a=>{s[a.asin]||(s[a.asin]={asin:a.asin,search_asin:a.search_asin,product_title:a.product_title,image_url:a.image_url,marketplaces:[]}),s[a.asin].marketplaces.push({marketplace:a.marketplace,completed_at:a.completed_at})}),Object.values(s)},[g]),j=r.useMemo(()=>{const s={all:l.length,US:0,CA:0,UK:0,DE:0};return l.forEach(a=>{s[a.marketplace]!==void 0&&s[a.marketplace]++}),s},[l]);return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-theme-primary flex items-center gap-3",children:"ðŸ“š ASIN Catalog"}),e.jsxs("p",{className:"text-theme-secondary mt-1",children:[m.length," products completed across ",l.length," marketplace uploads"]})]}),e.jsx("button",{onClick:f,disabled:i,className:"p-2 text-theme-secondary hover:text-accent transition-colors",title:"Refresh",children:e.jsx(_,{className:`w-5 h-5 ${i?"animate-spin":""}`})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(N,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-theme-tertiary"}),e.jsx("input",{type:"text",placeholder:"Search by ASIN or title...",value:c,onChange:s=>p(s.target.value),className:"w-full pl-10 pr-10 py-2 bg-theme-surface border border-theme rounded-lg text-theme-primary placeholder-theme-tertiary focus:outline-none focus:border-accent"}),c&&e.jsx("button",{onClick:()=>p(""),className:"absolute right-3 top-1/2 -translate-y-1/2 text-theme-tertiary hover:text-theme-primary",children:e.jsx(C,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs("button",{onClick:()=>u("all"),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1 ${n==="all"?"bg-accent text-white":"bg-theme-surface border border-theme text-theme-secondary hover:text-theme-primary"}`,children:["All (",j.all,")"]}),Object.entries(h).map(([s,{flag:a}])=>e.jsxs("button",{onClick:()=>u(s),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1 ${n===s?"bg-accent text-white":"bg-theme-surface border border-theme text-theme-secondary hover:text-theme-primary"}`,children:[a," (",j[s],")"]},s))]})]}),i&&l.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(k,{className:"w-8 h-8 animate-spin mx-auto mb-3 text-accent"}),e.jsx("p",{className:"text-theme-secondary",children:"Loading catalog..."})]}):m.length===0?e.jsxs("div",{className:"text-center py-12 bg-theme-surface rounded-lg border border-theme",children:[e.jsx("div",{className:"w-16 h-16 bg-theme-primary rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(N,{className:"w-8 h-8 text-theme-tertiary"})}),e.jsx("h3",{className:"text-lg font-medium text-theme-primary mb-1",children:c||n!=="all"?"No matches found":"No completed uploads yet"}),e.jsx("p",{className:"text-theme-secondary",children:c||n!=="all"?"Try adjusting your search or filters":"Complete upload tasks to build your catalog"})]}):e.jsxs("div",{className:"bg-theme-surface rounded-lg border border-theme overflow-hidden",children:[e.jsxs("div",{className:"hidden sm:grid sm:grid-cols-12 gap-4 px-4 py-3 bg-theme-primary border-b border-theme text-sm font-medium text-theme-secondary",children:[e.jsx("div",{className:"col-span-1",children:"Image"}),e.jsx("div",{className:"col-span-4",children:"Title"}),e.jsx("div",{className:"col-span-2",children:"ASIN"}),e.jsx("div",{className:"col-span-2",children:"Source"}),e.jsx("div",{className:"col-span-2",children:"Marketplaces"}),e.jsx("div",{className:"col-span-1"})]}),e.jsx("div",{className:"divide-y divide-theme",children:m.map(s=>e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-12 gap-4 px-4 py-3 items-center hover:bg-theme-hover transition-colors",children:[e.jsx("div",{className:"col-span-1 flex justify-center sm:justify-start",children:s.image_url?e.jsx("img",{src:s.image_url,alt:s.product_title||s.asin,className:"w-12 h-12 object-contain bg-white rounded"}):e.jsx("div",{className:"w-12 h-12 bg-theme-primary rounded flex items-center justify-center",children:e.jsx("span",{className:"text-2xl",children:"ðŸ“¦"})})}),e.jsx("div",{className:"col-span-4",children:e.jsx("p",{className:"text-theme-primary line-clamp-2 text-sm",children:s.product_title||"Title Not Available"})}),e.jsx("div",{className:"col-span-2",children:e.jsx("span",{className:"font-mono text-sm text-accent",children:s.asin})}),e.jsx("div",{className:"col-span-2",children:s.search_asin&&s.search_asin!==s.asin?e.jsx("span",{className:"font-mono text-sm text-theme-secondary",children:s.search_asin}):e.jsx("span",{className:"text-theme-tertiary text-sm",children:"â€”"})}),e.jsx("div",{className:"col-span-2 flex flex-wrap gap-1",children:s.marketplaces.map(({marketplace:a})=>{var t,o;return e.jsxs("span",{className:"inline-flex items-center gap-0.5 px-1.5 py-0.5 bg-success/10 text-success text-xs rounded",title:(t=h[a])==null?void 0:t.name,children:[e.jsx(A,{className:"w-3 h-3"}),(o=h[a])==null?void 0:o.flag]},a)})}),e.jsx("div",{className:"col-span-1 flex justify-end",children:e.jsx("a",{href:`https://www.amazon.com/dp/${s.asin}`,target:"_blank",rel:"noopener noreferrer",className:"text-accent hover:text-accent-hover",title:"View on Amazon",children:e.jsx(S,{className:"w-4 h-4"})})})]},s.asin))})]})]})}export{R as default};
//# sourceMappingURL=AsinCatalog-8c99aae8.js.map
