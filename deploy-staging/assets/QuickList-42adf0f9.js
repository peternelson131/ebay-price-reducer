import{s as A,j as e}from"./index-0231291c.js";import{r}from"./vendor-react-4c62d1cf.js";import"./vendor-supabase-5edd3635.js";import"./vendor-query-4b12add6.js";const _=[{id:"auth",label:"Authenticating"},{id:"keepa",label:"Fetching product data"},{id:"category",label:"Detecting category"},{id:"content",label:"Generating optimized title"},{id:"inventory",label:"Creating inventory item"},{id:"offer",label:"Creating offer"},{id:"publish",label:"Publishing listing"}],g=[{value:"NEW",label:"Brand New"},{value:"NEW_OTHER",label:"New (Open Box)"},{value:"LIKE_NEW",label:"Like New"},{value:"VERY_GOOD",label:"Very Good"},{value:"GOOD",label:"Good"},{value:"ACCEPTABLE",label:"Acceptable"},{value:"USED",label:"Used"}],y="list",b="settings";function pe(){const[w,d]=r.useState(y),[U,D]=r.useState(null),[l,O]=r.useState(!1),[k,ee]=r.useState([]),[F,te]=r.useState(null),[se,$]=r.useState(!0),[P,K]=r.useState(!1),[R,C]=r.useState(null),[z,I]=r.useState(null),[i,c]=r.useState({fulfillment_policy_id:"",payment_policy_id:"",return_policy_id:"",merchant_location_key:"",sku_prefix:"ql_",description_note:""}),[m,W]=r.useState(""),[f,G]=r.useState(""),[V,Q]=r.useState(1),[E,T]=r.useState("NEW"),[u,j]=r.useState(null),[J,N]=r.useState(g),[B,H]=r.useState(!1),[h,Z]=r.useState(!1),[p,v]=r.useState(null),[o,q]=r.useState(null),[M,L]=r.useState(null),S=/^B[0-9A-Z]{9}$/.test(m),re=f&&!isNaN(parseFloat(f))&&parseFloat(f)>0,Y=S&&re&&!h&&!B&&l;r.useEffect(()=>{ae()},[]);const ae=async()=>{$(!0),C(null);try{const{data:{session:t}}=await A.auth.getSession();if(!t)return;const a=await(await fetch("/.netlify/functions/quick-list-settings",{headers:{Authorization:`Bearer ${t.access_token}`}})).json();a.success&&(D(a.settings),O(a.isConfigured),ee(a.locations||[]),te(a.locationError||null),a.settings?c({fulfillment_policy_id:a.settings.fulfillment_policy_id||"",payment_policy_id:a.settings.payment_policy_id||"",return_policy_id:a.settings.return_policy_id||"",merchant_location_key:a.settings.merchant_location_key||"",sku_prefix:a.settings.sku_prefix||"ql_",description_note:a.settings.description_note||""}):a.primaryLocationKey&&c(n=>({...n,merchant_location_key:a.primaryLocationKey})),a.isConfigured||d(b))}catch(t){console.error("Failed to load settings:",t),C("Failed to load settings")}finally{$(!1)}},ne=async t=>{t.preventDefault(),K(!0),C(null),I(null);try{const{data:{session:s}}=await A.auth.getSession();if(!s)throw new Error("Not authenticated");const a=await fetch("/.netlify/functions/quick-list-settings",{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify(i)}),n=await a.json();if(!a.ok)throw new Error(n.error||n.message||"Failed to save settings");D(n.settings),O(!0),I("Settings saved successfully!"),setTimeout(()=>{d(y),I(null)},1500)}catch(s){C(s.message)}finally{K(!1)}},X=r.useCallback(async t=>{if(!t||!/^B[0-9A-Z]{9}$/.test(t)){j(null),N(g);return}H(!0);try{const{data:{session:s}}=await A.auth.getSession();if(!s)return;const n=await(await fetch("/.netlify/functions/validate-asin",{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({asin:t})})).json();if(n.success){j({title:n.title,imageUrl:n.imageUrl,categoryId:n.categoryId,categoryName:n.categoryName}),N(n.validConditions||g);const x=(n.validConditions||g).map(me=>me.value);x.includes(E)||T(n.defaultCondition||x[0])}else j(null),N(g)}catch(s){console.error("ASIN validation error:",s),N(g)}finally{H(!1)}},[E]);r.useEffect(()=>{if(!S){j(null);return}const t=setTimeout(()=>{X(m)},500);return()=>clearTimeout(t)},[m,S,X]);const ie=async()=>{for(let t=0;t<_.length;t++){v(t);const s=_[t].id==="content"?2e3:_[t].id==="publish"?1500:800;await new Promise(a=>setTimeout(a,s))}},le=async t=>{t.preventDefault(),Z(!0),L(null),q(null),v(0);try{const{data:{session:s}}=await A.auth.getSession();if(!s)throw new Error("Please log in to create listings");const a=ie(),n=await fetch("/.netlify/functions/auto-list-single",{method:"POST",headers:{Authorization:`Bearer ${s.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({asin:m,price:parseFloat(f),quantity:parseInt(V),condition:E,publish:!0})}),x=await n.json();if(await a,!n.ok)throw x.settingsRequired?(d(b),new Error("Please configure your Quick List settings first")):new Error(x.message||x.error||"Failed to create listing");q(x),v(_.length)}catch(s){console.error("Listing creation error:",s),L(s.message),v(null)}finally{Z(!1)}},ce=()=>{W(""),G(""),Q(1),T("NEW"),j(null),N(g),q(null),L(null),v(null)},oe=()=>e.jsx("div",{className:"space-y-6",children:e.jsxs("form",{onSubmit:ne,className:"space-y-6",children:[e.jsx("div",{className:"p-4 bg-accent/10 border border-accent/30 rounded-lg",children:e.jsxs("p",{className:"text-sm text-theme-secondary",children:[e.jsx("strong",{children:"Where to find these IDs:"})," Go to eBay Seller Hub ‚Üí Account Settings ‚Üí Business Policies. Click on each policy to see its ID in the URL or policy details."]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-medium text-theme-primary flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"üìã"})," Business Policies",e.jsx("span",{className:"text-xs text-error",children:"*Required"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-secondary mb-1",children:"Shipping / Fulfillment Policy ID"}),e.jsx("input",{type:"text",value:i.fulfillment_policy_id,onChange:t=>c(s=>({...s,fulfillment_policy_id:t.target.value.trim()})),placeholder:"e.g., 107540197026",className:"w-full px-4 py-3 bg-theme-primary border border-theme rounded-lg focus:ring-2 focus:ring-accent focus:border-accent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-secondary mb-1",children:"Payment Policy ID"}),e.jsx("input",{type:"text",value:i.payment_policy_id,onChange:t=>c(s=>({...s,payment_policy_id:t.target.value.trim()})),placeholder:"e.g., 243561626026",className:"w-full px-4 py-3 bg-theme-primary border border-theme rounded-lg focus:ring-2 focus:ring-accent focus:border-accent",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-secondary mb-1",children:"Return Policy ID"}),e.jsx("input",{type:"text",value:i.return_policy_id,onChange:t=>c(s=>({...s,return_policy_id:t.target.value.trim()})),placeholder:"e.g., 243561625026",className:"w-full px-4 py-3 bg-theme-primary border border-theme rounded-lg focus:ring-2 focus:ring-accent focus:border-accent",required:!0})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-medium text-theme-primary flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"üìç"})," Merchant Location",e.jsx("span",{className:"text-xs text-error",children:"*Required"})]}),F?e.jsxs("div",{className:"p-4 bg-error/10 border border-error/30 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-error",children:["Failed to load locations: ",F]}),e.jsx("p",{className:"text-xs text-theme-tertiary mt-2",children:"You can still enter a location key manually below."}),e.jsx("input",{type:"text",value:i.merchant_location_key,onChange:t=>c(s=>({...s,merchant_location_key:t.target.value.trim()})),placeholder:"e.g., loc-94e1f3a0-6e1b-4d23-befc-750fe183",className:"w-full mt-2 px-4 py-3 bg-theme-primary border border-theme rounded-lg focus:ring-2 focus:ring-accent focus:border-accent",required:!0})]}):k.length===0?e.jsxs("div",{className:"p-4 bg-warning/10 border border-warning/30 rounded-lg",children:[e.jsx("p",{className:"text-sm text-warning",children:"No merchant locations found. Please ensure your eBay account is connected and has at least one location configured."}),e.jsx("input",{type:"text",value:i.merchant_location_key,onChange:t=>c(s=>({...s,merchant_location_key:t.target.value.trim()})),placeholder:"Enter location key manually",className:"w-full mt-2 px-4 py-3 bg-theme-primary border border-theme rounded-lg focus:ring-2 focus:ring-accent focus:border-accent",required:!0})]}):e.jsxs("div",{children:[e.jsxs("select",{value:i.merchant_location_key,onChange:t=>c(s=>({...s,merchant_location_key:t.target.value})),className:"w-full px-4 py-3 bg-theme-primary border border-theme rounded-lg focus:ring-2 focus:ring-accent focus:border-accent",required:!0,children:[e.jsx("option",{value:"",children:"Select a location..."}),k.map(t=>e.jsxs("option",{value:t.key,children:[t.name,t.isPrimary?" ‚≠ê":""," - ",t.address||t.type]},t.key))]}),e.jsxs("p",{className:"mt-1 text-xs text-theme-tertiary",children:[k.length," location",k.length!==1?"s":""," found ‚Ä¢ ‚≠ê = Primary"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-medium text-theme-primary flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"üè∑Ô∏è"})," SKU Settings"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-secondary mb-1",children:"SKU Prefix"}),e.jsx("input",{type:"text",value:i.sku_prefix,onChange:t=>c(s=>({...s,sku_prefix:t.target.value.replace(/[^a-zA-Z0-9_]/g,"").substring(0,10)})),placeholder:"ql_",maxLength:10,className:"w-full px-4 py-3 bg-theme-primary border border-theme rounded-lg focus:ring-2 focus:ring-accent focus:border-accent"}),e.jsxs("p",{className:"mt-1 text-xs text-theme-tertiary",children:["All SKUs will start with this prefix (e.g., ",i.sku_prefix||"ql_","B01KJEOCDW)"]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"font-medium text-theme-primary flex items-center gap-2",children:[e.jsx("span",{className:"text-lg",children:"üìù"})," Custom Description Note"]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-secondary mb-1",children:"Note to append to all listings (optional)"}),e.jsx("textarea",{value:i.description_note,onChange:t=>c(s=>({...s,description_note:t.target.value.substring(0,1e3)})),placeholder:"e.g., Ships from Wisconsin. Contact us with any questions!",rows:3,maxLength:1e3,className:"w-full px-4 py-3 bg-theme-primary border border-theme rounded-lg focus:ring-2 focus:ring-accent focus:border-accent"}),e.jsxs("p",{className:"mt-1 text-xs text-theme-tertiary",children:[i.description_note.length,"/1000 characters"]})]})]}),R&&e.jsx("div",{className:"p-4 bg-error/10 border border-error/30 rounded-lg",children:e.jsx("p",{className:"text-sm text-error",children:R})}),z&&e.jsx("div",{className:"p-4 bg-success/10 border border-success/30 rounded-lg",children:e.jsx("p",{className:"text-sm text-success",children:z})}),e.jsx("button",{type:"submit",disabled:P,className:`w-full py-3 px-6 rounded-lg font-medium transition-colors ${P?"bg-gray-200 dark:bg-gray-700 text-theme-tertiary cursor-not-allowed":"bg-accent text-white hover:bg-accent-hover"}`,children:P?"Saving...":"Save Settings"})]})}),de=()=>e.jsxs("div",{className:"space-y-6",children:[!l&&e.jsx("div",{className:"p-4 bg-warning/10 border border-warning/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-warning text-2xl",children:"‚ö†Ô∏è"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-warning",children:"Setup Required"}),e.jsx("p",{className:"text-sm text-theme-secondary mt-1",children:"Please configure your Quick List settings before creating listings."}),e.jsx("button",{onClick:()=>d(b),className:"mt-2 text-sm text-accent hover:underline",children:"Go to Settings ‚Üí"})]})]})}),o&&e.jsx("div",{className:"p-4 bg-success/10 border border-success/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-success text-2xl",children:"‚úì"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-success",children:"Listing Created!"}),e.jsx("p",{className:"text-sm text-theme-secondary mt-1",children:o.title}),e.jsxs("div",{className:"mt-3 grid grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-theme-tertiary",children:"SKU:"})," ",e.jsx("span",{className:"font-mono",children:o.sku})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-theme-tertiary",children:"Category:"})," ",e.jsx("span",{children:o.categoryName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-theme-tertiary",children:"Price:"})," ",e.jsxs("span",{className:"text-success font-semibold",children:["$",o.price]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-theme-tertiary",children:"Time:"})," ",e.jsxs("span",{children:[(o.elapsedMs/1e3).toFixed(1),"s"]})]})]}),o.listingUrl&&e.jsx("a",{href:o.listingUrl,target:"_blank",rel:"noopener noreferrer",className:"mt-4 inline-flex items-center gap-2 px-4 py-2 bg-accent text-white rounded-lg hover:bg-accent-hover transition-colors",children:"View on eBay ‚Üí"}),e.jsx("button",{onClick:ce,className:"mt-4 ml-3 px-4 py-2 text-theme-secondary hover:text-theme-primary transition-colors",children:"Create Another"})]})]})}),M&&e.jsx("div",{className:"p-4 bg-error/10 border border-error/30 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-error text-2xl",children:"‚úó"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-error",children:"Failed to Create Listing"}),e.jsx("p",{className:"text-sm text-theme-secondary mt-1",children:M}),e.jsx("button",{onClick:()=>L(null),className:"mt-2 text-sm text-accent hover:underline",children:"Try Again"})]})]})}),h&&p!==null&&e.jsxs("div",{className:"p-4 bg-theme-primary rounded-lg",children:[e.jsx("h3",{className:"font-medium text-theme-primary mb-3",children:"Creating listing..."}),e.jsx("div",{className:"space-y-2",children:_.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-5 h-5 rounded-full flex items-center justify-center text-xs ${s<p?"bg-success text-white":s===p?"bg-accent text-white animate-pulse":"bg-gray-200 dark:bg-gray-700 text-theme-tertiary"}`,children:s<p?"‚úì":s===p?"...":s+1}),e.jsx("span",{className:s<=p?"text-theme-primary":"text-theme-tertiary",children:t.label})]},t.id))})]}),!o&&e.jsxs("form",{onSubmit:le,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-secondary mb-1",children:"Amazon ASIN"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:m,onChange:t=>W(t.target.value.toUpperCase()),placeholder:"B01KJEOCDW",maxLength:10,className:`w-full px-4 py-3 bg-theme-primary border rounded-lg focus:ring-2 focus:ring-accent focus:border-accent transition-colors ${m&&!S?"border-error":"border-theme"}`,disabled:h||!l}),B&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx("div",{className:"w-5 h-5 border-2 border-accent border-t-transparent rounded-full animate-spin"})})]}),m&&!S&&e.jsx("p",{className:"mt-1 text-sm text-error",children:"ASIN must start with B followed by 9 alphanumeric characters"})]}),u&&e.jsx("div",{className:"p-3 bg-theme-primary rounded-lg border border-theme",children:e.jsxs("div",{className:"flex gap-3",children:[u.imageUrl&&e.jsx("img",{src:u.imageUrl,alt:u.title,className:"w-16 h-16 object-contain rounded"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm text-theme-primary font-medium truncate",children:u.title}),e.jsxs("p",{className:"text-xs text-theme-tertiary mt-1",children:["Category: ",u.categoryName]})]})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-secondary mb-1",children:"Listing Price (USD)"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-4 top-1/2 -translate-y-1/2 text-theme-tertiary",children:"$"}),e.jsx("input",{type:"number",step:"0.01",min:"0.01",value:f,onChange:t=>G(t.target.value),placeholder:"24.99",className:"w-full pl-8 pr-4 py-3 bg-theme-primary border border-theme rounded-lg focus:ring-2 focus:ring-accent focus:border-accent transition-colors",disabled:h||!l})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-theme-secondary mb-1",children:"Quantity"}),e.jsx("input",{type:"number",min:"1",max:"10000",value:V,onChange:t=>Q(parseInt(t.target.value)||1),className:"w-full px-4 py-3 bg-theme-primary border border-theme rounded-lg focus:ring-2 focus:ring-accent focus:border-accent transition-colors",disabled:h||!l})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-theme-secondary mb-1",children:["Condition",u&&e.jsxs("span",{className:"ml-2 text-xs text-theme-tertiary font-normal",children:["(",J.length," options for this category)"]})]}),e.jsx("select",{value:E,onChange:t=>T(t.target.value),className:"w-full px-4 py-3 bg-theme-primary border border-theme rounded-lg focus:ring-2 focus:ring-accent focus:border-accent transition-colors",disabled:h||B||!l,children:J.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})]}),l&&U&&e.jsxs("div",{className:"p-3 bg-theme-primary rounded-lg border border-theme text-xs text-theme-tertiary",children:[e.jsx("span",{className:"font-medium",children:"Using:"})," ",'SKU prefix "',e.jsx("span",{className:"font-mono",children:U.sku_prefix}),'"',e.jsx("button",{type:"button",onClick:()=>d(b),className:"ml-2 text-accent hover:underline",children:"View/Change Settings"})]}),e.jsx("button",{type:"submit",disabled:!Y,className:`w-full py-3 px-6 rounded-lg font-medium transition-colors ${Y?"bg-accent text-white hover:bg-accent-hover":"bg-gray-200 dark:bg-gray-700 text-theme-tertiary cursor-not-allowed"}`,children:h?"Creating Listing...":l?"Create eBay Listing":"Configure Settings First"})]})]});return se?e.jsx("div",{className:"max-w-2xl mx-auto",children:e.jsx("div",{className:"bg-theme-surface rounded-lg border border-theme p-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-6 h-6 border-2 border-accent border-t-transparent rounded-full animate-spin"}),e.jsx("span",{className:"text-theme-secondary",children:"Loading settings..."})]})})}):e.jsxs("div",{className:"max-w-2xl mx-auto space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-theme-primary",children:"Quick List"}),e.jsx("p",{className:"text-theme-secondary mt-1",children:"Create an eBay listing from an Amazon ASIN in seconds"})]}),e.jsxs("div",{className:"flex border-b border-theme",children:[e.jsx("button",{onClick:()=>d(y),className:`px-6 py-3 font-medium border-b-2 transition-colors ${w===y?"text-accent border-accent":"text-theme-tertiary border-transparent hover:text-theme-secondary"}`,children:"üì¶ Create Listing"}),e.jsxs("button",{onClick:()=>d(b),className:`px-6 py-3 font-medium border-b-2 transition-colors flex items-center gap-2 ${w===b?"text-accent border-accent":"text-theme-tertiary border-transparent hover:text-theme-secondary"}`,children:["‚öôÔ∏è Settings",!l&&e.jsx("span",{className:"w-2 h-2 bg-error rounded-full"})]})]}),e.jsx("div",{className:"bg-theme-surface rounded-lg border border-theme p-6",children:w===y?de():oe()}),w===y&&l&&e.jsxs("div",{className:"bg-theme-surface rounded-lg border border-theme p-4",children:[e.jsx("h3",{className:"font-medium text-theme-primary mb-2",children:"How it works"}),e.jsxs("ol",{className:"text-sm text-theme-secondary space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Enter an Amazon ASIN and your desired price"}),e.jsx("li",{children:"We fetch product data from Keepa"}),e.jsx("li",{children:"AI generates an optimized 80-character title"}),e.jsx("li",{children:"eBay category is auto-detected"}),e.jsx("li",{children:"Listing is created and published instantly"})]})]})]})}export{pe as default};
//# sourceMappingURL=QuickList-42adf0f9.js.map
