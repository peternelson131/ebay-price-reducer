{"version":3,"file":"AsinCatalog-8c99aae8.js","sources":["../../src/pages/AsinCatalog.jsx"],"sourcesContent":["/**\n * AsinCatalog Component\n * \n * Displays completed influencer tasks as a searchable catalog\n */\n\nimport { useState, useEffect, useMemo } from 'react';\nimport { userAPI } from '../lib/supabase';\nimport { \n  Search,\n  Filter,\n  Loader,\n  RefreshCw,\n  ExternalLink,\n  CheckCircle,\n  X\n} from 'lucide-react';\n\n// Marketplace flags and info\nconst MARKETPLACES = {\n  US: { name: 'United States', flag: 'ðŸ‡ºðŸ‡¸', domain: 'amazon.com' },\n  CA: { name: 'Canada', flag: 'ðŸ‡¨ðŸ‡¦', domain: 'amazon.ca' },\n  UK: { name: 'United Kingdom', flag: 'ðŸ‡¬ðŸ‡§', domain: 'amazon.co.uk' },\n  DE: { name: 'Germany', flag: 'ðŸ‡©ðŸ‡ª', domain: 'amazon.de' }\n};\n\nexport default function AsinCatalog() {\n  const [tasks, setTasks] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [searchQuery, setSearchQuery] = useState('');\n  const [marketplaceFilter, setMarketplaceFilter] = useState('all');\n\n  useEffect(() => {\n    loadCompletedTasks();\n  }, []);\n\n  const loadCompletedTasks = async () => {\n    setLoading(true);\n    try {\n      const token = await userAPI.getAuthToken();\n      const response = await fetch('/.netlify/functions/influencer-tasks?status=completed', {\n        headers: { 'Authorization': `Bearer ${token}` }\n      });\n      const data = await response.json();\n      if (data.success) {\n        setTasks(data.tasks || []);\n      }\n    } catch (err) {\n      console.error('Failed to load completed tasks:', err);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  // Filter and search tasks\n  const filteredTasks = useMemo(() => {\n    return tasks.filter(task => {\n      // Marketplace filter\n      if (marketplaceFilter !== 'all' && task.marketplace !== marketplaceFilter) {\n        return false;\n      }\n      // Search filter (ASIN or title)\n      if (searchQuery) {\n        const query = searchQuery.toLowerCase();\n        const matchesAsin = task.asin?.toLowerCase().includes(query) || \n                           task.search_asin?.toLowerCase().includes(query);\n        const matchesTitle = task.product_title?.toLowerCase().includes(query);\n        if (!matchesAsin && !matchesTitle) {\n          return false;\n        }\n      }\n      return true;\n    });\n  }, [tasks, marketplaceFilter, searchQuery]);\n\n  // Group by ASIN for cleaner display\n  const groupedByAsin = useMemo(() => {\n    const groups = {};\n    filteredTasks.forEach(task => {\n      if (!groups[task.asin]) {\n        groups[task.asin] = {\n          asin: task.asin,\n          search_asin: task.search_asin,\n          product_title: task.product_title,\n          image_url: task.image_url,\n          marketplaces: []\n        };\n      }\n      groups[task.asin].marketplaces.push({\n        marketplace: task.marketplace,\n        completed_at: task.completed_at\n      });\n    });\n    return Object.values(groups);\n  }, [filteredTasks]);\n\n  // Count by marketplace for filter badges\n  const marketplaceCounts = useMemo(() => {\n    const counts = { all: tasks.length, US: 0, CA: 0, UK: 0, DE: 0 };\n    tasks.forEach(task => {\n      if (counts[task.marketplace] !== undefined) {\n        counts[task.marketplace]++;\n      }\n    });\n    return counts;\n  }, [tasks]);\n\n  return (\n    <div className=\"p-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between mb-6\">\n        <div>\n          <h1 className=\"text-2xl font-bold text-theme-primary flex items-center gap-3\">\n            ðŸ“š ASIN Catalog\n          </h1>\n          <p className=\"text-theme-secondary mt-1\">\n            {groupedByAsin.length} products completed across {tasks.length} marketplace uploads\n          </p>\n        </div>\n        <button\n          onClick={loadCompletedTasks}\n          disabled={loading}\n          className=\"p-2 text-theme-secondary hover:text-accent transition-colors\"\n          title=\"Refresh\"\n        >\n          <RefreshCw className={`w-5 h-5 ${loading ? 'animate-spin' : ''}`} />\n        </button>\n      </div>\n\n      {/* Search and Filter Bar */}\n      <div className=\"flex flex-col sm:flex-row gap-4 mb-6\">\n        {/* Search */}\n        <div className=\"relative flex-1\">\n          <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-theme-tertiary\" />\n          <input\n            type=\"text\"\n            placeholder=\"Search by ASIN or title...\"\n            value={searchQuery}\n            onChange={(e) => setSearchQuery(e.target.value)}\n            className=\"w-full pl-10 pr-10 py-2 bg-theme-surface border border-theme rounded-lg text-theme-primary placeholder-theme-tertiary focus:outline-none focus:border-accent\"\n          />\n          {searchQuery && (\n            <button\n              onClick={() => setSearchQuery('')}\n              className=\"absolute right-3 top-1/2 -translate-y-1/2 text-theme-tertiary hover:text-theme-primary\"\n            >\n              <X className=\"w-4 h-4\" />\n            </button>\n          )}\n        </div>\n\n        {/* Marketplace Filter */}\n        <div className=\"flex gap-2 flex-wrap\">\n          <button\n            onClick={() => setMarketplaceFilter('all')}\n            className={`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1 ${\n              marketplaceFilter === 'all'\n                ? 'bg-accent text-white'\n                : 'bg-theme-surface border border-theme text-theme-secondary hover:text-theme-primary'\n            }`}\n          >\n            All ({marketplaceCounts.all})\n          </button>\n          {Object.entries(MARKETPLACES).map(([code, { flag }]) => (\n            <button\n              key={code}\n              onClick={() => setMarketplaceFilter(code)}\n              className={`px-3 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-1 ${\n                marketplaceFilter === code\n                  ? 'bg-accent text-white'\n                  : 'bg-theme-surface border border-theme text-theme-secondary hover:text-theme-primary'\n              }`}\n            >\n              {flag} ({marketplaceCounts[code]})\n            </button>\n          ))}\n        </div>\n      </div>\n\n      {/* Loading State */}\n      {loading && tasks.length === 0 ? (\n        <div className=\"text-center py-12\">\n          <Loader className=\"w-8 h-8 animate-spin mx-auto mb-3 text-accent\" />\n          <p className=\"text-theme-secondary\">Loading catalog...</p>\n        </div>\n      ) : groupedByAsin.length === 0 ? (\n        <div className=\"text-center py-12 bg-theme-surface rounded-lg border border-theme\">\n          <div className=\"w-16 h-16 bg-theme-primary rounded-full flex items-center justify-center mx-auto mb-4\">\n            <Search className=\"w-8 h-8 text-theme-tertiary\" />\n          </div>\n          <h3 className=\"text-lg font-medium text-theme-primary mb-1\">\n            {searchQuery || marketplaceFilter !== 'all' ? 'No matches found' : 'No completed uploads yet'}\n          </h3>\n          <p className=\"text-theme-secondary\">\n            {searchQuery || marketplaceFilter !== 'all' \n              ? 'Try adjusting your search or filters'\n              : 'Complete upload tasks to build your catalog'}\n          </p>\n        </div>\n      ) : (\n        /* Catalog List */\n        <div className=\"bg-theme-surface rounded-lg border border-theme overflow-hidden\">\n          {/* Header Row */}\n          <div className=\"hidden sm:grid sm:grid-cols-12 gap-4 px-4 py-3 bg-theme-primary border-b border-theme text-sm font-medium text-theme-secondary\">\n            <div className=\"col-span-1\">Image</div>\n            <div className=\"col-span-4\">Title</div>\n            <div className=\"col-span-2\">ASIN</div>\n            <div className=\"col-span-2\">Source</div>\n            <div className=\"col-span-2\">Marketplaces</div>\n            <div className=\"col-span-1\"></div>\n          </div>\n\n          {/* List Items */}\n          <div className=\"divide-y divide-theme\">\n            {groupedByAsin.map((item) => (\n              <div \n                key={item.asin}\n                className=\"grid grid-cols-1 sm:grid-cols-12 gap-4 px-4 py-3 items-center hover:bg-theme-hover transition-colors\"\n              >\n                {/* Image */}\n                <div className=\"col-span-1 flex justify-center sm:justify-start\">\n                  {item.image_url ? (\n                    <img \n                      src={item.image_url} \n                      alt={item.product_title || item.asin}\n                      className=\"w-12 h-12 object-contain bg-white rounded\"\n                    />\n                  ) : (\n                    <div className=\"w-12 h-12 bg-theme-primary rounded flex items-center justify-center\">\n                      <span className=\"text-2xl\">ðŸ“¦</span>\n                    </div>\n                  )}\n                </div>\n\n                {/* Title */}\n                <div className=\"col-span-4\">\n                  <p className=\"text-theme-primary line-clamp-2 text-sm\">\n                    {item.product_title || 'Title Not Available'}\n                  </p>\n                </div>\n\n                {/* ASIN */}\n                <div className=\"col-span-2\">\n                  <span className=\"font-mono text-sm text-accent\">{item.asin}</span>\n                </div>\n\n                {/* Source ASIN */}\n                <div className=\"col-span-2\">\n                  {item.search_asin && item.search_asin !== item.asin ? (\n                    <span className=\"font-mono text-sm text-theme-secondary\">{item.search_asin}</span>\n                  ) : (\n                    <span className=\"text-theme-tertiary text-sm\">â€”</span>\n                  )}\n                </div>\n\n                {/* Marketplaces */}\n                <div className=\"col-span-2 flex flex-wrap gap-1\">\n                  {item.marketplaces.map(({ marketplace }) => (\n                    <span \n                      key={marketplace}\n                      className=\"inline-flex items-center gap-0.5 px-1.5 py-0.5 bg-success/10 text-success text-xs rounded\"\n                      title={MARKETPLACES[marketplace]?.name}\n                    >\n                      <CheckCircle className=\"w-3 h-3\" />\n                      {MARKETPLACES[marketplace]?.flag}\n                    </span>\n                  ))}\n                </div>\n\n                {/* Actions */}\n                <div className=\"col-span-1 flex justify-end\">\n                  <a\n                    href={`https://www.amazon.com/dp/${item.asin}`}\n                    target=\"_blank\"\n                    rel=\"noopener noreferrer\"\n                    className=\"text-accent hover:text-accent-hover\"\n                    title=\"View on Amazon\"\n                  >\n                    <ExternalLink className=\"w-4 h-4\" />\n                  </a>\n                </div>\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n"],"names":["MARKETPLACES","AsinCatalog","tasks","setTasks","useState","loading","setLoading","searchQuery","setSearchQuery","marketplaceFilter","setMarketplaceFilter","useEffect","loadCompletedTasks","token","userAPI","data","err","filteredTasks","useMemo","task","query","matchesAsin","_a","_b","matchesTitle","_c","groupedByAsin","groups","marketplaceCounts","counts","jsxs","jsx","RefreshCw","Search","e","X","code","flag","Loader","item","marketplace","CheckCircle","ExternalLink"],"mappings":"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"}