import{c as U,u as C,j as e}from"./index-0231291c.js";import{r as l}from"./vendor-react-4c62d1cf.js";import{R as _}from"./refresh-cw-6c475bbf.js";import{C as k}from"./circle-alert-a9c91508.js";import{C as h,L}from"./loader-43bf0082.js";import{E as p}from"./external-link-a2bb9e65.js";import{T as E}from"./trash-2-71e25496.js";import"./vendor-supabase-5edd3635.js";import"./vendor-query-4b12add6.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const F=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],T=U("rotate-ccw",F),u={US:{name:"United States",flag:"ðŸ‡ºðŸ‡¸",domain:"amazon.com",uploadUrl:"https://www.amazon.com/creatorhub/video/upload"},CA:{name:"Canada",flag:"ðŸ‡¨ðŸ‡¦",domain:"amazon.ca",uploadUrl:"https://www.amazon.ca/creatorhub/video/upload"},UK:{name:"United Kingdom",flag:"ðŸ‡¬ðŸ‡§",domain:"amazon.co.uk",uploadUrl:"https://www.amazon.co.uk/creatorhub/video/upload"},DE:{name:"Germany",flag:"ðŸ‡©ðŸ‡ª",domain:"amazon.de",uploadUrl:"https://www.amazon.de/creatorhub/video/upload"}};function G(){const[g,A]=l.useState([]),[i,f]=l.useState(!0),[c,z]=l.useState(0),[n,S]=l.useState("pending");l.useEffect(()=>{d()},[]);const d=async()=>{f(!0);try{const t=await C.getAuthToken(),s=await(await fetch("/.netlify/functions/influencer-tasks",{headers:{Authorization:`Bearer ${t}`}})).json();s.success&&(A(s.tasks||[]),z(s.pendingCount||0))}catch(t){console.error("Failed to load tasks:",t)}finally{f(!1)}},m=async(t,r)=>{try{const s=await C.getAuthToken();await fetch("/.netlify/functions/influencer-tasks",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${s}`},body:JSON.stringify({taskId:t,action:r})}),d()}catch(s){console.error(`Failed to ${r} task:`,s)}},j=g.filter(t=>n==="all"?!0:t.status===n),$=j.reduce((t,r)=>(t[r.asin]||(t[r.asin]=[]),t[r.asin].push(r),t),{});return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-2xl font-bold text-theme-primary flex items-center gap-3",children:["ðŸ“‹ Upload Tasks",c>0&&e.jsxs("span",{className:"px-3 py-1 bg-error text-white text-sm font-bold rounded-full animate-pulse",children:[c," pending"]})]}),e.jsx("p",{className:"text-theme-secondary mt-1",children:"Videos to upload for accepted ASIN correlations"})]}),e.jsx("button",{onClick:d,disabled:i,className:"p-2 text-theme-secondary hover:text-accent transition-colors",title:"Refresh",children:e.jsx(_,{className:`w-5 h-5 ${i?"animate-spin":""}`})})]}),e.jsx("div",{className:"flex gap-2 mb-6",children:[{key:"pending",label:"Pending",icon:k,color:"error"},{key:"completed",label:"Completed",icon:h,color:"success"},{key:"all",label:"All",icon:null,color:"accent"}].map(({key:t,label:r,icon:s,color:o})=>e.jsxs("button",{onClick:()=>S(t),className:`px-4 py-2 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 ${n===t?`bg-${o} text-white`:"bg-theme-surface text-theme-secondary hover:text-theme-primary border border-theme"}`,style:n===t?{backgroundColor:`var(--color-${o})`}:{},children:[s&&e.jsx(s,{className:"w-4 h-4"}),r,t==="pending"&&c>0&&e.jsxs("span",{className:"ml-1",children:["(",c,")"]})]},t))}),i&&g.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(L,{className:"w-8 h-8 animate-spin mx-auto mb-3 text-accent"}),e.jsx("p",{className:"text-theme-secondary",children:"Loading tasks..."})]}):j.length===0?e.jsxs("div",{className:"text-center py-12 bg-theme-surface rounded-lg border border-theme",children:[e.jsx("div",{className:"w-16 h-16 bg-theme-primary rounded-full flex items-center justify-center mx-auto mb-4",children:n==="pending"?e.jsx(h,{className:"w-8 h-8 text-success"}):e.jsx(k,{className:"w-8 h-8 text-theme-tertiary"})}),e.jsx("h3",{className:"text-lg font-medium text-theme-primary mb-1",children:n==="pending"?"All caught up!":"No tasks yet"}),e.jsx("p",{className:"text-theme-secondary",children:n==="pending"?"You have no pending upload tasks":"Accept ASIN correlations to create upload tasks"})]}):e.jsx("div",{className:"space-y-6",children:Object.entries($).map(([t,r])=>{const s=r[0],o=s==null?void 0:s.image_url,N=s==null?void 0:s.product_title,b=s==null?void 0:s.search_asin;return e.jsxs("div",{className:"bg-theme-surface rounded-lg border border-theme overflow-hidden",children:[e.jsx("div",{className:"p-4 bg-theme-primary border-b border-theme",children:e.jsxs("div",{className:"flex gap-4",children:[o?e.jsx("img",{src:o,alt:N||t,className:"w-20 h-20 object-contain bg-white rounded-lg flex-shrink-0"}):e.jsx("div",{className:"w-20 h-20 bg-theme-surface rounded-lg flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-3xl",children:"ðŸ“¦"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-theme-primary line-clamp-2 mb-2",children:N||"Product Title Not Available"}),e.jsxs("div",{className:"flex flex-wrap gap-x-4 gap-y-1 text-sm",children:[b&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-theme-tertiary",children:"Search:"}),e.jsx("span",{className:"font-mono text-theme-secondary",children:b})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"text-theme-tertiary",children:"Variation:"}),e.jsx("span",{className:"font-mono text-accent font-semibold",children:t})]})]}),e.jsxs("div",{className:"mt-2 flex items-center gap-2",children:[e.jsxs("span",{className:`text-xs font-medium px-2 py-0.5 rounded-full ${r.filter(a=>a.status==="pending").length===0?"bg-success/20 text-success":"bg-error/20 text-error"}`,children:[r.filter(a=>a.status==="pending").length," of ",r.length," remaining"]}),e.jsxs("a",{href:`https://www.amazon.com/dp/${t}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-accent hover:text-accent-hover flex items-center gap-1",children:["View on Amazon ",e.jsx(p,{className:"w-3 h-3"})]})]})]})]})}),e.jsx("div",{className:"divide-y divide-theme",children:r.map(a=>{var y,w,v;return e.jsxs("div",{className:`flex items-center justify-between p-4 ${a.status==="completed"?"opacity-60 bg-success/5":""}`,children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-2xl",children:(y=u[a.marketplace])==null?void 0:y.flag}),e.jsxs("div",{children:[e.jsx("p",{className:`font-medium text-theme-primary ${a.status==="completed"?"line-through":""}`,children:(w=u[a.marketplace])==null?void 0:w.name}),e.jsx("p",{className:"text-sm text-theme-tertiary",children:a.status==="completed"?`Completed ${new Date(a.completed_at).toLocaleDateString()}`:`Created ${new Date(a.created_at).toLocaleDateString()}`})]})]}),e.jsx("div",{className:"flex items-center gap-2",children:a.status==="pending"?e.jsxs(e.Fragment,{children:[e.jsxs("a",{href:a.amazon_upload_url,target:"_blank",rel:"noopener noreferrer",className:"px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white text-sm rounded-lg transition-colors flex items-center gap-1",title:"View product on Amazon",children:["Product ",e.jsx(p,{className:"w-3 h-3"})]}),e.jsxs("a",{href:(v=u[a.marketplace])==null?void 0:v.uploadUrl,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 text-sm rounded-lg transition-colors flex items-center gap-2 font-medium",style:{backgroundColor:"#FF9900",color:"#111"},onMouseOver:x=>x.currentTarget.style.backgroundColor="#E88B00",onMouseOut:x=>x.currentTarget.style.backgroundColor="#FF9900",title:"Go to Amazon Influencer upload page",children:["Upload ",e.jsx(p,{className:"w-4 h-4"})]}),e.jsxs("button",{onClick:()=>m(a.id,"complete"),className:"px-4 py-2 bg-success text-white text-sm rounded-lg hover:bg-success/80 transition-colors flex items-center gap-2",children:[e.jsx(h,{className:"w-4 h-4"})," Done"]})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>m(a.id,"reopen"),className:"px-3 py-2 text-theme-secondary hover:text-theme-primary text-sm transition-colors flex items-center gap-1",title:"Reopen task",children:e.jsx(T,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>m(a.id,"delete"),className:"px-3 py-2 text-error/60 hover:text-error text-sm transition-colors flex items-center gap-1",title:"Delete task",children:e.jsx(E,{className:"w-4 h-4"})})]})})]},a.id)})})]},t)})})]})}export{G as default};
//# sourceMappingURL=InfluencerTaskList-a1861620.js.map
